import{c as C}from"./index-BOqttFVv.js";import{r as n,j as r}from"./ui-DVJ6EJIP.js";import{I as N}from"./input-BEVEn5os.js";import{L as b}from"./label-DiwqgwnN.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=C("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),R=({value:A,onChange:m,onPlaceSelect:u,placeholder:z="Enter address",id:x="address-autocomplete",label:h,className:I="",error:f,disabled:p=!1,types:v=["address"],componentRestrictions:j={country:"us"}})=>{const y=n.useRef(null),w=n.useRef(null),[c,d]=n.useState(!1);return n.useEffect(()=>{if(window.google&&window.google.maps&&window.google.maps.places){d(!0);return}const o=document.querySelector('script[src*="maps.googleapis.com/maps/api/js"]');if(o){const a=setInterval(()=>{window.google&&window.google.maps&&(window.google.maps.places?(d(!0),clearInterval(a)):(o.src||"").includes("libraries=places"))},100);return setTimeout(()=>{clearInterval(a),window.google&&window.google.maps&&window.google.maps.places&&d(!0)},5e3),()=>clearInterval(a)}const e=document.createElement("script"),t="AIzaSyCPiwvpr4dC6-Iuz0pdZCnfg9_jNO-zP50",i=`initGoogleMapsAutocomplete_${Date.now()}`;return e.src=`https://maps.googleapis.com/maps/api/js?key=${t}&libraries=places&callback=${i}`,e.async=!0,e.defer=!0,e.onerror=()=>{console.error("Failed to load Google Maps API. Please check your API key and ensure the Places API is enabled."),d(!1)},window[i]=()=>{window.google&&window.google.maps&&window.google.maps.places&&(d(!0),console.log("âœ… Google Maps Places API loaded successfully for autocomplete")),setTimeout(()=>{window[i]&&delete window[i]},1e3)},document.head.appendChild(e),()=>{e.parentNode&&e.parentNode.removeChild(e),window[i]&&delete window[i]}},[]),n.useEffect(()=>{if(!(!c||!y.current||!window.google))try{const o=new window.google.maps.places.Autocomplete(y.current,{fields:["address_components","formatted_address","geometry","name","place_id"],types:v,componentRestrictions:j});return w.current=o,o.addListener("place_changed",()=>{const e=o.getPlace();if(console.log("ðŸ” Place changed event fired:",e),!e.geometry||!e.geometry.location){console.warn("âš ï¸ No geometry found for selected place"),e.formatted_address&&m(e.formatted_address);return}const t={};if(e.address_components?.forEach(s=>{const l=s.types;l.includes("street_number")&&(t.streetNumber=s.long_name),l.includes("route")&&(t.route=s.long_name),l.includes("locality")&&(t.city=s.long_name),!t.city&&l.includes("sublocality")&&(t.city=s.long_name),!t.city&&l.includes("sublocality_level_1")&&(t.city=s.long_name),!t.city&&l.includes("neighborhood")&&(t.city=s.long_name),l.includes("administrative_area_level_1")&&(t.state=s.short_name||s.long_name),l.includes("postal_code")&&(t.zipCode=s.long_name)}),!t.city&&e.formatted_address){const s=e.formatted_address.split(",");s.length>=2&&(t.city=s[1]?.trim().split(" ")[0]||"")}const a=[t.streetNumber,t.route].filter(Boolean).join(" ").trim()||e.formatted_address||e.name||"",g=typeof e.geometry.location.lat=="function"?e.geometry.location.lat():e.geometry.location.lat,_=typeof e.geometry.location.lng=="function"?e.geometry.location.lng():e.geometry.location.lng;console.log("âœ… Extracted data:",{address:a,city:t.city,state:t.state,zipCode:t.zipCode,coordinates:{lat:g,lng:_}}),m(a),u&&(u({address:a,city:t.city||"",state:t.state||"",zipCode:t.zipCode||"",latitude:g,longitude:_,formattedAddress:e.formatted_address||a}),console.log("ðŸ“ Address selected and callback called:",{address:a,city:t.city,state:t.state,zipCode:t.zipCode,coordinates:{lat:g,lng:_}}))}),()=>{w.current&&window.google.maps.event.clearInstanceListeners(w.current)}}catch(o){console.error("Error initializing autocomplete:",o)}},[c,m,u,v,j]),r.jsxs("div",{className:"w-full",children:[h&&r.jsx(b,{htmlFor:x,className:"mb-2 block",children:h}),r.jsx("div",{className:"relative",children:r.jsx(N,{ref:y,id:x,type:"text",value:A,onChange:o=>m(o.target.value),placeholder:z,className:f?`border-red-500 ${I}`:I,disabled:p})}),f&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:f}),!c&&!p&&"AIzaSyCPiwvpr4dC6-Iuz0pdZCnfg9_jNO-zP50"&&r.jsxs("p",{className:"text-xs text-gray-500 mt-1 flex items-center gap-1",children:[r.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-gray-500"}),"Loading address autocomplete..."]}),c&&!p&&"AIzaSyCPiwvpr4dC6-Iuz0pdZCnfg9_jNO-zP50"&&r.jsxs("p",{className:"text-xs text-green-600 mt-1 flex items-center gap-1",children:[r.jsx("span",{children:"âœ“"}),"Address autocomplete ready - Start typing to see suggestions"]}),!c&&!p&&!1]})};export{R as A,L as S};
